# 過去の投稿履歴の検索・フィルタリング機能（カレンダー＆タグ）

過去のデッサン投稿履歴を「月次カレンダー」と「タグ」で直感的にフィルタリングできる機能を実装しました。3回のデザイン変更を経て、ユーザビリティの高いレイアウトに着地しました。

## 実装概要

### 1. UI/UXの改善 (Frontend)
ユーザーフィードバックに基づき、以下のUIコンポーネントを導入しました。

- **2カラムレイアウト (70% / 30%)**:
  - **左カラム**: 新規アップロード + 履歴一覧（グリッド表示）
  - **右カラム**: カレンダーフィルター + タグサイドバー（追従サイドバー）
- **Calendar Filter**:
  - 月ごとの投稿状況をカレンダー形式で可視化。
  - 投稿がある日付にはインジケーターを表示。
  - 日付クリックで一覧を絞り込み。
- **Tag Sidebar**:
  - 使用頻度順にタグを表示。
  - タグクリックで一覧を絞り込み。

### 2. 検索ロジック (Client-side)
現在はクライアントサイドで全件データを取得し、メモリ上でフィルタリングを行っています。
データ量が増加した場合は、将来的にサーバーサイドフィルタリングへの移行も可能です。

## コードの変更点

```bash
packages/web/src/
├── app/page.tsx                  # [MODIFY] レイアウトと状態管理を集約
├── components/features/dashboard/
│   ├── CalendarFilter.tsx        # [NEW] 月次カレンダーコンポーネント
│   ├── TagSidebar.tsx            # [NEW] タグ一覧サイドバー
│   ├── TaskGrid.tsx              # [NEW] 純粋なタスク一覧表示コンポーネント
│   └── TaskList.tsx              # [DELETE] 廃止（機能分割）
└── hooks/useTasks.ts             # [MODIFY] クエリパラメータ対応（バックエンド準備）
```

## 検証結果

### 動作確認
- [x] **カレンダー操作**: 月切り替え、日付選択による絞り込みが正常に動作することを確認。
- [x] **タグ操作**: タグ選択による絞り込みが正常に動作することを確認。
- [x] **相互フィルタリング (Mutual Filtering)**:
  - タグ選択時、カレンダー上のマーカーが「そのタグを持つタスク」のみに更新されること。
  - 日付選択時、タグリストのカウントが「その日のタスク」のみに更新されること。
- [x] **複合条件**: 日付とタグを両方選択した場合のAND検索を確認。
- [x] **レスポンシブ**: スマホ表示時にカラムが縦積みになり、崩れないことを確認。

### ビルド検証
`npm run build` によりビルドエラーがないことを確認済み。

## デプロイ情報 (2026-01-21)
- **Backend (Cloud Run)**: https://<project>-<PROJECT_ID>.asia-northeast1.run.app
- **Frontend (Firebase Hosting)**: https://<project>.web.app
